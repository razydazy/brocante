
{% comment %}theme-check-disable MissingTemplate{% endcomment %}
{%- liquid
  assign section_color = section.settings.color_scheme
  assign counter = 0
  assign feature_second_level_links = section.settings.feature_second_level_links
  assign accordion_transition = 'x-cloak'
-%}
<section class="section-sidebar" x-data="ThemeSection_{{ section.id }}()" x-init="mounted()" data-section-id="{{ section.id }}" data-section-type="sidebar" x-cloak>
  <noscript>
    <div class="section-x-padding py-2 text-right">
      <button class="py-2 inline-flex items-center justify-center {% if settings.header_uppercase %}uppercase{% endif %}"
        data-menu-drawer-toggle>
      <span class="inline-block w-5 h-5 align-middle mr-2">{%- render 'icon-menu' -%}</span>
      <span>{{ 'layout.navigation.menu' | t }}</span>
      </button>
    </div>
  </noscript>
  <div class="sidebar-container z-100 menu-drawer fixed top-0 left-0 bottom-0  w-11/12 max-w-md px-4 py-4 bg-scheme-background text-scheme-text transform overflow-y-auto"
    data-color-scheme="{{ section_color }}"
    x-show="$store.drawer.menuDrawerOpen"
    x-transition:enter="transition ease duration-300"
    x-transition:enter-start="opacity-0 -translate-x-full"
    x-transition:leave="transition ease duration-300"
    x-transition:leave-end="-translate-x-full"
    @click.away.prevent="$store.drawer.menuDrawerOpen = false"
    role="dialog"
    aria-modal="true"
    data-menu-drawer>
    <div class="js-enabled flex justify-end">
      <button @click.prevent="$store.drawer.menuDrawerOpen = false" class="">
        <span class="inline-block w-7 h-7 align-middle">{% render 'icon-close' %}</span>
        <span class="visually-hidden"> {{ 'layout.drawers.close_menu' | t }}</span>
      </button>
    </div>
    <div class="flex justify-between py-4 items-center font-heading text-2xl border-b-theme-width border-scheme-border">
      {% capture image_size %}{{ section.settings.logo_max_width | escape }}x{% endcapture %}
      {% capture image_size_px %}{{ section.settings.logo_max_width | escape }}px{% endcapture %}
      {% capture image_size_2x %}{{ section.settings.logo_max_width | times: 2 }}x{% endcapture %}
      {% if section.settings.logo %}
        <a href="{{ routes.root_url }}" class="site-header__logo-link">
          {% comment %}theme-check-disable ImgWidthAndHeight{% endcomment %}
          <img src="{{ section.settings.logo | img_url: image_size_2x }}" alt="{{ shop.name }}" width="{{ image_size }}">
          {% comment %}theme-check-enable ImgWidthAndHeight{% endcomment %}
        </a>
      {% else %}
        <a href="{{ routes.root_url }}">{{ shop.name }}</a>
      {% endif %}
    </div>
    <nav class="mt-8" aria-label="{{ 'layout.navigation.primary' | t }}">
      <ul>
        {%- for link in linklists[section.settings.main_linklist].links -%}
          {%- liquid
            assign feature_counter = counter
            assign have_feature_links = false
            assign all_feature_links = false
            assign feature_link_count = 0
          -%}
          {%- capture link_class -%}font-secondary inline-block py-4 hover:text-scheme-accent focus:text-scheme-accent{%- endcapture -%}
          <li class="no-js-focus-wrapper">
            {%- if link.links != blank -%}
              {%- capture child_link_class -%}font-body inline-block py-2 hover:text-scheme-accent focus:text-scheme-accent{%- endcapture -%}
              <button data-accordion
                      class="block relative w-full text-left {{ link_class }} pr-10 transition ease font-body"
                      x-bind:aria-expanded="accordionOpen.accordion{{ counter }}? true: 'false'"
                      @click="accordionOpen.accordion{{ counter }} = !accordionOpen.accordion{{ counter }}"
                      aria-controls="accordion{{ counter }}">
                {{ link.title }}
                <span class="absolute right-0 w-3 top-1/2 transform -translate-y-1/2 flex items-center">
                  <span class="inline-block transform transition origin-center" :class="{'rotate-180': accordionOpen.accordion{{ counter }}}">
                    {%- render 'icon-chevron-down' -%}
                  </span>
                </span>
              </button>
              {%- liquid
                assign single_level_links = link.links | where: "levels", 0
                assign product_links = single_level_links | where: "type", "product_link"
                assign collection_links = single_level_links | where: "type", "collection_link"
                assign feature_link_count = product_links.size | plus: collection_links.size
                if feature_link_count > 0
                  assign have_feature_links = true
                endif
                if feature_link_count == link.links.size
                  assign all_feature_links = true
                endif
              %}
              {%- unless all_feature_links and feature_second_level_links -%}
              <ul id="accordion{{ counter }}"
                  class="no-js-focus-container pb-4"
                  x-show="accordionOpen.accordion{{ counter }}"
                  {{ accordion_transition }}>
                {%- assign counter = counter | plus: 1 -%}
                {%- for child_link in link.links -%}
                  {% liquid
                    assign is_feature_link = false
                    if child_link.type == 'product_link' or child_link.type == 'collection_link' and child_link.levels == 0
                      assign is_feature_link = true
                    endif
                  %}
                  {%- unless is_feature_link and feature_second_level_links -%}
                    <li class="no-js-focus-wrapper">
                      {%- if child_link.links != blank -%}
                        <button data-accordion
                                class="relative w-full text-left {{ child_link_class }} pr-10"
                                x-bind:aria-expanded="accordionOpen.accordion{{ counter }}? true: 'false'"
                                @click="accordionOpen.accordion{{ counter }} = !accordionOpen.accordion{{ counter }}"
                                aria-controls="accordion{{ counter }}">
                          {{ child_link.title }}
                          <span class="absolute w-3 right-0 top-1/2 transform -translate-y-1/2 flex items-center">
                            <span class="inline-block transform transition origin-center" :class="{'rotate-180': accordionOpen.accordion{{ counter }}}">
                              {%- render 'icon-chevron-down' -%}
                            </span>
                          </span>
                        </button>
                        <ul id="accordion{{ counter }}"
                            class="pt-1 pb-4 no-js-focus-container"
                            x-show="accordionOpen.accordion{{ counter }}"
                            {{ accordion_transition }}>
                        {%- assign counter = counter | plus: 1 -%}
                          {%- for grandchild_link in child_link.links -%}
                          <li>
                            <a class="text-base ml-6 py-2 block" href="{{ grandchild_link.url }}">
                              {{ grandchild_link.title }}
                            </a>
                          </li>
                        {%- endfor -%}
                        </ul>
                      {%- else -%}
                        <a class="{{ child_link_class }}" href="{{ child_link.url }}">
                          {{ child_link.title }}
                        </a>
                      {%- endif -%}
                    </li>
                  {%- endunless -%}
                {%- endfor -%}
              </ul>
              {%- endunless -%}
            {%- else -%}
              <a class="{{ link_class }}" href="{{ link.url }}">
                {{ link.title }}
              </a>
            {%- endif -%}
            {%- if have_feature_links and feature_second_level_links -%}
              <ul id="accordion-feature-links-{{ feature_counter }}"
              class="no-js-focus-container pt-4 pb-8 grid grid-cols-2 gap-5"
              x-show="accordionOpen.accordion{{ feature_counter }}"
              {{ accordion_transition }}>
                {% for child_link in link.links %}
                  {%- if child_link.type == 'product_link' or child_link.type == 'collection_link' and child_link.levels == 0 -%}
                    <li>
                      {%- if child_link.type == 'product_link' -%}
                        {%- assign product = child_link.object -%}
                        <a href="{{ product.url }}">
                          {%- if product.featured_media != blank -%}
                            {%- render 'responsive-image' with
                              image: product.featured_media.preview_image
                            -%}
                          {%- endif -%}
                          <div class="mt-4 {{ settings.product_grid_font }} {% if settings.product_grid_align == 'center' %}text-center{% endif %}">
                            <h3 class="text-sm">
                              {% if settings.products_split_title and product.title contains '-' %}
                                {%- assign title = product.title | split: '-' -%}
                                <p class="product-grid-title">{{ title | last | strip }}</p>
                                <p class="mt-1">{{ title | first | strip }}</p>
                              {% else %}
                                <p class="product-grid-title">{{ product.title }}</p>
                              {% endif %}
                            </h3>
                          </div>
                        </a>
                      {%- else -%}
                        {%- assign collection = child_link.object -%}
                        <a href="{{ collection.url }}">
                          {%- if collection.image != blank -%}
                            {% render 'image-crop' with
                              image: collection.image,
                              ratio: section.settings.collection_image_crop | plus: 0.0
                            %}
                          {%- endif -%}
                          <div class="mt-4 {{ settings.product_grid_font }} {% if settings.product_grid_align == 'center' %}text-center{% endif %}">
                            <h3 class="text-sm">
                              <p class="product-grid-title">{{ collection.title }}</p>
                            </h3>
                          </div>
                        </a>
                      {%- endif -%}
                    </li>
                  {%- endif -%}
                {%- endfor -%}
              </ul>
            {%- endif -%}
          </li>
        {%- endfor -%}
      </ul>
    </nav>

    <div class="mt-8 border-t-theme-width border-scheme-border">
      {%- if linklists[section.settings.secondary_menu].links.size > 0 -%}
      <nav class="mt-8" aria-label="Secondary">
        <ul>
          {%- for link in linklists[section.settings.secondary_menu].links -%}
            <li>
              <a class="block py-2" href="{{ link.url }}">
                {{ link.title }}
              </a>
            </li>
          {%- endfor -%}
        </ul>
      {%- endif -%}

      {% if shop.customer_accounts_enabled %}
        <ul class="mt-8 space-y-2">
          {% if customer %}
            <li>
              <a href="{{ routes.account_url }}">{{ 'layout.customer.account' | t }}</a>
            </li>
            <li>
              {{ 'layout.customer.log_out' | t | customer_logout_link }}
            </li>
          {% else %}
            <li>
              {{ 'layout.customer.log_in' | t | customer_login_link }}
            </li>
            <li>
              {{ 'layout.customer.create_account' | t | customer_register_link }}
            </li>
          {% endif %}
        </ul>
      {% endif %}
      {%- if section.settings.show_search -%}
        <form class="mt-8" action="{{ routes.search_url }}" method="get" role="search">
          <div class="relative text-scheme-meta">
            <label for="{{ section.id }}-search" class="visually-hidden">{{ 'general.search.placeholder' | t }}</label>
            <input
              class="w-full flex-auto text-scheme-text bg-transparent placeholder-scheme-meta pr-2 py-2 pl-8"
              id="{{ section.id }}-search"
              type="text"
              name="q"
              placeholder="{{ 'general.search.placeholder' | t }}"
            />
            <button class="absolute top-1/2 h-5 transform -translate-y-1/2 left-0 px-1"
              type="submit">
              <span class="inline-block w-5 h-5">{%- render 'icon-search' -%}</span>
              <span class="visually-hidden">{{ 'general.search.submit' | t }}</span>
            </button>
          </div>
        </form>
      {%- endif -%}
      {% if section.settings.show_social %}
        <div class="text-scheme-meta mt-8">
          {% render 'social-icons' %}
        </div>
      {% endif %}

        <div style="
    line-height: 200%;
    padding-left: 0px;
              margin-top: 20px;
    display: flex
;
    letter-spacing: var(--secondary-letterspacing);
;">
Open. 13:00p.m-18:00p.m<br>
Closed. 火水木<br>
address.3-7-7 jiyugaoka<br>
meguro  tokyo 〒152-0035<br>
03-3725-5584
        </div>
        <a href="https://brocante-jp.biz/" target="_blank" style="font-size: 1.3rem;
    margin-top: 20px;
    display: block;
    margin-bottom: 20px;
    letter-spacing: var(--secondary-letterspacing);">
        Official Site
        </a>
    </div>
  </div>
</section>
{% comment %}theme-check-enable MissingTemplate{% endcomment %}
<noscript>
<style>
  .section-sidebar {
    display: block !important;
  }

  .sidebar-container {
    position: static;
    width: 100%;
    max-width: 100%;
    border-right: 0;
    display: none;
  }

  .section-sidebar:focus-within .sidebar-container {
    display: block !important;
  }
</style>
</noscript>

{% schema %}
  {
    "name": "Sidebar Menu",
    "class": "sidebar-menu",
    "settings": [
      {
        "type": "link_list",
        "id": "main_linklist",
        "label": "Menu",
        "default": "main-menu"
      },
      {
        "type": "checkbox",
        "id": "feature_second_level_links",
        "label": "Feature second level links",
        "info": "This will feature second level links that are products or collections and move them out of the natural order into their own area.  [Learn more](http://www.google.com)"
      },
      {
        "type": "select",
        "id": "collection_image_crop",
        "label": "Collection image crop",
        "info": "This will apply to collection images if feature second links is enabled.",
        "options": [
          {
            "value": "0",
            "label": "No crop"
          },
          {
            "value": "0.8",
            "label": "Portrait"
          },
          {
            "value": "1",
            "label": "Square"
          },
          {
            "value": "1.3",
            "label": "Landscape"
          }
        ],
        "default": "1"
      },
      {
        "type": "link_list",
        "id": "secondary_menu",
        "label": "Secondary menu"
      },
      {
        "type": "header",
        "content": "Logo"
      },
      {
        "type": "image_picker",
        "id": "logo",
        "label": "Custom logo",
        "info": "800 x 300px recommended."
      },
      {
        "type":      "range",
        "id":        "logo_max_width",
        "min":       80,
        "max":        270,
        "step":       10,
        "unit":       "px",
        "label":     "Custom logo width",
        "default":   270
      },
      {
        "type": "checkbox",
        "id": "show_search",
        "label": "Show search"
      },
      {
        "type": "checkbox",
        "id": "show_social",
        "label": "Show social icons"
      },
      {
        "type": "header",
        "content": "Color"
      },
      {
        "type": "select",
        "id": "color_scheme",
        "label": "Color scheme",
        "options": [
            { "value": "primary", "label": "Primary"},
            { "value": "secondary", "label": "Secondary"},
            { "value": "tertiary", "label": "Tertiary"}
        ],
        "default":   "primary"
      }
    ]
  }
{% endschema %}
